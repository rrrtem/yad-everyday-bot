# Миграция CRM с Vite на Next.js

## Что было изменено

### ✅ Технологический стек
- **Было:** React + Vite + React Router
- **Стало:** Next.js 14 + App Router + TypeScript
- **Деплой:** С GitHub Pages на Supabase Hosting

### ✅ Архитектурные изменения

#### Структура проекта
```
/CRM/src/
├── app/                      # Next.js App Router
│   ├── api/users/           # API route для работы с Supabase
│   ├── dashboard/           # Страница дэшборда
│   ├── login/               # Страница логина
│   ├── layout.tsx           # Главный лейаут
│   ├── page.tsx             # Корневая страница
│   └── globals.css          # Глобальные стили
├── components/              # React компоненты (обновлены)
├── lib/                     # Утилиты (Supabase клиент)
└── constants.ts             # Централизованные константы
```

#### Следование правилам проекта
1. ✅ **Все настройки в constants.ts** — вынесены по группам функций
2. ✅ **Все текстовые сообщения** — централизованы в UI_MESSAGES
3. ✅ **Группировка по юз-кейсам** — константы сгруппированы логично

### ✅ Компоненты обновлены

#### LoginForm
- Использует константы из `constants.ts`
- Стили вынесены в `STYLES`
- Сообщения в `UI_MESSAGES.LOGIN`

#### Filters
- Исправлена типизация для Radix UI
- Все лейблы в `FILTER_LABELS`
- Стили централизованы

#### UserCard
- Форматирование дат вынесено в методы
- Цвета статусов в `STATUS_COLORS`  
- Лейблы полей в `USER_FIELDS_LABELS`

#### UserList
- Сообщения загрузки/пустого состояния централизованы
- Использует цвета из `STATUS_COLORS`

### ✅ API архитектура
- **Было:** Прямые запросы к Supabase с фронтенда
- **Стало:** Next.js API Routes `/api/users`
- Лучшая безопасность и контроль доступа

### ✅ Конфигурация и деплой
- `next.config.js` — настройка для статического экспорта 
- `supabase/config.toml` — конфигурация Supabase Hosting
- `.env.example` — шаблон переменных окружения
- Обновлены README и ТЗ

## Как использовать

### Локальная разработка
```bash
cd CRM
npm install
cp .env.example .env.local
# Заполнить переменные окружения
npm run dev
```

### Деплой на Supabase
```bash
npm run build
supabase deploy
```

### Деплой на Vercel (рекомендуется)
1. Подключить репозиторий к Vercel
2. Добавить переменные окружения
3. Автоматический деплой

## Преимущества новой архитектуры

1. **Лучшая производительность** — Next.js оптимизации
2. **Модульность** — четкое разделение ответственности
3. **Типизация** — строгие TypeScript интерфейсы
4. **Централизация** — все настройки в одном месте
5. **Расширяемость** — легко добавлять новые функции
6. **Безопасность** — API Routes вместо прямых запросов
7. **SEO** — возможности Next.js для будущих улучшений

## Готовность к продакшену
- ✅ Сборка без ошибок
- ✅ Линтинг прошел
- ✅ TypeScript валидация
- ✅ Статический экспорт настроен
- ✅ Переменные окружения настроены
- ✅ Документация обновлена 