# YAD Everyday Bot

Телеграм-бот для проекта "Ясность&Движение / Каждый день" - челлендж по написанию ежедневных текстов.

## Структура проекта

```
supabase/
  functions/
    bot/                    # Единая Edge Function для всего функционала
      index.ts             # Главный файл - точка входа
      commandHandler.ts    # Обработка команд бота (/start, /get, /comeback и т.д.)
      postHandler.ts       # Обработка постов с тегом #daily
      userHandler.ts       # Работа с пользователями (регистрация, обновление)
      cronHandler.ts       # Cron-задачи (ежедневная проверка, месячный сброс)
      logic.md             # Подробное описание логики работы
    constants.ts           # Все настройки и константы проекта
```

## Текущие задачи
- [x] Объединить bot и cron функции в одну Edge Function
- [x] Вынести обработку команд в отдельный файл
- [ ] Добавить обработку штрафов (penalty система)
- [ ] Реализовать автоматическое удаление из чата при 0 жизней
- [ ] Добавить тесты для основных сценариев

## Выполненные задачи
- ✅ Создана базовая структура бота
- ✅ Реализована обработка команд /start, /get, /comeback
- ✅ Добавлена обработка постов с тегом #daily
- ✅ Реализованы cron-функции для ежедневной проверки
- ✅ Добавлены команды владельца (/daily, /remind, /month)
- ✅ Вынесены все константы в отдельный файл
- ✅ Создана единая Edge Function для всего функционала

## Будущие задачи
- [ ] Добавить веб-интерфейс для статистики
- [ ] Реализовать экспорт данных в CSV
- [ ] Добавить поддержку нескольких языков
- [ ] Создать админ-панель для управления челленджем

## Развертывание

1. Установите Supabase CLI
2. Настройте переменные окружения в `.env`
3. Запустите `supabase functions deploy bot`

## Переменные окружения

- `TELEGRAM_BOT_TOKEN` - токен бота от @BotFather
- `TELEGRAM_GROUP_CHAT_ID` - ID группового чата
- `SUPABASE_URL` - URL вашего Supabase проекта
- `SUPABASE_SERVICE_ROLE_KEY` - Service role key
